[http://www.biosql.org/wiki/Main_Page BioSQL] is a joint effort between the [http://open-bio.org/ OBF] projects (BioPerl, BioJava etc) to support a shared database schema for storing sequence data.  In theory, you could load a GenBank file into the database with BioPerl, then extract this from the database as a [[SeqRecord]] with featues using Biopython - and get more or less the same thing as if you had loaded the GenBank file directly using [[SeqIO]].

Existing documentation for the Biopython interfaces to BioSQL cover installing Python database adaptors and basic usage of BioSQL:

[http://biopython.org/DIST/docs/biosql/python_biosql_basic.html HTML] |  [http://biopython.org/DIST/docs/biosql/python_biosql_basic.pdf PDF]

I hope to use this wiki page to update the above documentation in future.

=== Installation ===

This is fairly complicated - partly because there are some many options. For example, you can use a range of different SQL database packages (we'll focus on MySQL), you can have the database on your own computer (the assumption here) or on a separate server.  Also the details will vary depending on your operating system.

This text is based in part on the [http://code.open-bio.org/cgi/viewcvs.cgi/*checkout*/biosql-schema/INSTALL?rev=HEAD&cvsroot=biosql&content-type=text/plain BioSQL scheme INSTALL instructions], which also covers alternatives to MySQL.

== Installing Required Software ==

You will need to install some database software plus the associated python library so that Biopython can "talk" to the database.  In this example we'll talk about the most common choice, MySQL.  How you do this will also depend on your operating system, for example on a Debian or Ubuntu Linux machine try this:

 sudo apt-get install mysql-common mysql-server mysql-admin python-mysqldb

It will also be important to have perl (to run some of the setup scripts) and cvs (to get some BioSQL files).  Again, on a Debian or Ubuntu Linux machine try this:

 sudo apt-get install perl

You may find perl is already installed.

== Downloading the BioSQL Schema ==

One the software is installed, your next task is to setup a database and import the BioSQL scheme (i.e. setup the relevant tables within the database).  If you have CVS installed, then on Linux you can download the latest schema like this (password is 'cvs').

 cd ~
 mkdir repository
 cd repository
 cvs -d :pserver:cvs@code.open-bio.org:/home/repository/biopython checkout biosql
 cvs -d :pserver:cvs@code.open-bio.org:/home/repository/biosql checkout biosql-schema
 cd biosql-schema/sql

If you don't want to use CVS, then download the files via the [http://cvs.open-bio.org/cgi-bin/viewcvs/viewcvs.cgi/?cvsroot=biosql View CVS web interface]. Click the Download tarball link to get a tar.gz file containing the all the current CVS file, and then unzip that. Or, navigate to the relevant file for your database and download just that, e.g. [http://cvs.open-bio.org/cgi-bin/viewcvs/viewcvs.cgi/biosql-schema/sql/biosqldb-mysql.sql?cvsroot=biosql biosql-schema/sql/biosqldb-mysql.sql] for MySQL.

== Creating the empty database ==

Assuming you are using MySQL, the following command line should create a new database on your own computer called ''bioseqdb'', belonging to the ''root'' user account:

 mysqladmin -u root create bioseqdb

We can then tell MySQL to load the BioSQL scheme we downloaded above (file ~/repository/biosql-schema/sql/biosqldb-mysql.sql if you downloaded the files where we suggested).

 cd ~/repository/biosql-schema/sql
 mysql -u root bioseqdb < biosqldb-mysql.sql

On Linux you can check this did something via the MySQL Administration GUI which we suggested installing earlier.  This should be available via the main program menu, but you can also invoke it from the command line:

 mysql-admin

Select ''localhost'' as the Server Hostman (i.e. your local machine) and ''root'' as the username, then click connect.  Once the main window appears, if you click on "Catalogs" on the left, you should see a new entry for ''bioseqdb''.

== NCBI Taxonomy ==

Before you start trying to load sequences into the database, it is a good idea to load the NCBI taxonomy database using the scripts/load_ncbi_taxonomy.pl script in the BioSQL package.

The script should be able to download the files it needs from the [ftp://ftp.ncbi.nih.gov/pub/taxonomy/ NCBI taxonomy FTP site] automatically:

 cd ~/repository/biosql-schema/scripts
 ./load_ncbi_taxonomy.pl --dbname bioseqdb --driver mysql --dbuser root --download true

There is about 10MB to fetch, so it can take a little while (and doesn't give any feedback while this happens).  If you are worried, open a file browser window and check to see it is downloading a file called taxdump.tar.gz to the taxdata subdirectory.

You should see this output at the command prompt - be warned that some of these steps do take a while (especially '''rebuilding nested set left/right values'''):

 Loading NCBI taxon database in taxdata:
         ... retrieving all taxon nodes in the database
         ... reading in taxon nodes from nodes.dmp
         ... insert / update / delete taxon nodes
         ... (committing nodes)
         ... rebuilding nested set left/right values
         ... reading in taxon names from names.dmp
         ... deleting old taxon names
         ... inserting new taxon names

etc